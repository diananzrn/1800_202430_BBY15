<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Home</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" />
</head>

<body>
    <nav class="navbar navbar-expand navbar-dark" style="background-color: rgb(13, 173, 13);">
        <div class="container-fluid">
            <a class="navbar-brand" style="color: rgb(0, 87, 0);">Where to?</a>
            <form class="d-flex" role="search">
                <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"
                    style="border-radius: 2em;   width: 100%;">
                <button class="btn" type="submit">
                    <i class="fas fa-search"></i>
                </button>
            </form>
        </div>
    </nav>

    <main>
        <div class="container-fluid">
            <div class="row">
                <hr>
                <iframe
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d5208.893478803497!2d-123.00446662401433!3d49.24897787314099!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x54867721fd53fee5%3A0x355ab207647a109d!2sBritish%20Columbia%20Institute%20of%20Technology!5e0!3m2!1sen!2sca!4v1730010939104!5m2!1sen!2sca"
                    width="100%" height="400vh" style="margin: 0;" allowfullscreen="" loading="lazy"
                    referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
        </div>
<!-- changed the stops near you so no hardcoding is needed -->
 <!-- It now gets the two stops from the database -->
        <div class="card" style="margin-top: 1%;">
            <h5 class="card-header">Stops near you</h5>
            <div class="card-body">
              <h5 class="card-title" id="stop1"></h5>
              <div class="routes">
                <span class="route-number" id="NB1"></span>
                <span class="route-number" id="NB2"></span>
                <span class="route-number" id="NB3"></span>
            </div>
            <i class="far fa-bookmark"data-stop-id="stop1" style="float: right; scale: 2;"></i>
            <a href="#" class="btn" style="margin-top: 3%;">Go to route</a>
            </div>
          </div>
        <div class="card">
            <div class="card-body">
              <h5 class="card-title" id="stop2"></h5>
              <div class="routes">
                <span class="route-number" id="south1"></span>
                <span class="route-number" id="south2"></span>
                <span class="route-number" id="south3"></span>
            </div>
            <i class="far fa-bookmark" data-stop-id="stop2" style="float: right; scale: 2;"></i>
            <a href="#" class="btn" style="margin-top: 3%;">Go to route</a>
            </div>
          </div>

        
    </main>

    <footer class="navbar navbar-expand navbar-dark fixed-bottom bottom-navbar"
        style="background-color: rgb(13, 173, 13); position:sticky;">
        <div class="container-fluid justify-content-around" style="float: right;">
            <a href="login.html" class="navbar-brand">
                <i class="fas fa-user-circle" style="color: rgb(0, 87, 0); scale: 1.8;"></i>
            </a>
            <a href="home.html" class="navbar-brand">
                <i class="fas fa-home" style="color: rgb(0, 87, 0); scale: 1.8;"></i>
            </a>
            <a href="favorites.html" class="navbar-brand">
                <i class="far fa-bookmark" style="color: rgb(0, 87, 0); scale: 1.8;"></i>
            </a>
        </div>
    </footer>

   <!-- Load Firebase first --> 
   <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
   <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
   <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>

<!-- Then load your Firebase config --> 
<script src="./scripts/firebaseAPI_TEAM15.js"></script>

<!-- Finally load your main script --> 
<script src="./scripts/main.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Retrieve favorites from localStorage
        let favorites = JSON.parse(localStorage.getItem('favorites')) || {};

        // Update bookmark icons based on favorites
        document.querySelectorAll('.fa-bookmark').forEach(bookmark => {
            const stopId = bookmark.getAttribute('data-stop-id');

            // Check if the stop is in favorites and update the icon accordingly
            if (favorites[stopId]) {
                bookmark.classList.add('fas'); // Light up the bookmark icon
                bookmark.classList.remove('far'); // Remove the outline class
            } else {
                bookmark.classList.remove('fas'); // Ensure the icon is not lit
                bookmark.classList.add('far'); // Add the outline class
            }

            // Add event listener for bookmark clicks
            bookmark.addEventListener('click', () => {
                const isFavorite = bookmark.classList.toggle('fas'); // Toggle between filled and outlined
                bookmark.classList.toggle('far');

                const titleElement = document.querySelector(`#${stopId}`);
                const title = titleElement ? titleElement.textContent : '';

                if (isFavorite) {
                    addToFavorites(stopId, title);
                } else {
                    removeFromFavorites(stopId, title);
                }
            });
        });
    });

    function addToFavorites(stopId, title) {
        let favorites = JSON.parse(localStorage.getItem('favorites')) || {};
        favorites[stopId] = title;
        localStorage.setItem('favorites', JSON.stringify(favorites));
        console.log(`Added to favorites: ${title}`);
    }

    function removeFromFavorites(stopId, title) {
        let favorites = JSON.parse(localStorage.getItem('favorites')) || {};
        delete favorites[stopId];
        localStorage.setItem('favorites', JSON.stringify(favorites));
        console.log(`Removed from favorites: ${stopId}`);
    }
</script>




    
    
    
</body>

</html>